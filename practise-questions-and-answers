1. Employees Earning More Than Their Managers.
Answer:
select e1.name as Employee
from employee e1
inner join employee e2
on e1.managerid = e2.id
where e1.salary > e2.salary;

2. Second Highest Salary, if there is no value then print null.
Answer:
select max(salary) as SecondHighestSalary
from (
select e1.*, dense_rank() over(order by e1.salary desc) as rnk
from employee e1
) where rnk = 2;

3. Find the employee with second highest salary from each department, if there is no value then print null.
Answer:
select max(salary) as SecondHighestSalary
from (
select e1.*, dense_rank() over(partition by id order by e1.salary desc) as rnk
from employee e1
) where rnk = 2;

4. Find customers who are not present in the orders table.
SELECT first_name, age
FROM Customers c
left join orders o
on c.customer_id = o.customer_id
where o.customer_id is null;

5. find the change in employee status from 2020 to 2021 -> Example of full outer join.

